# FC 部署补丁文档

本文档记录使用阿里云 FC3 时的已知限制与临时补丁方案，供 CI/CD 配置和运维排障时参考。

## 已知限制

- FC3 发布后不返回版本号，也无法使用别名进行灰度或快速回滚。
- 触发器默认指向最新部署，无法手动切流；回滚只能依赖重新发布旧代码。
- 版本不可见导致数据库迁移必须保持向前兼容，防止回滚后出现不一致。

## 补丁方案

1. **部署流程调整**：流水线跳过版本/别名创建，发布后立即生效，并在部署后执行健康检查。
2. **回滚策略**：通过 Git revert 触发重新部署；若云端保留历史版本，可在控制台手动回退。
3. **数据库守则**：所有迁移保持向前兼容；紧急回滚时执行反向迁移或停用新增字段。
4. **监控与告警**：部署后立即观察应用与数据库指标，异常时优先回滚代码再处理数据。
5. **待验证特性**：持续关注 FC3 对版本/别名的支持进度，若官方补齐，应恢复标准蓝绿策略。
