# Secrets & Variables 清单

统一梳理 CI/CD、部署、前端构建所需的 GitHub Secrets / Variables 以及用途。新增或变更请同步此文档，并更新 `scripts/setup.env.example`（用于初始化）。

## GitHub Actions Secrets

| 名称                                                | 用途                            | 备注                             |
| --------------------------------------------------- | ------------------------------- | -------------------------------- |
| `ALIYUN_ACCESS_KEY_ID` / `ALIYUN_ACCESS_KEY_SECRET` | 阿里云 AK，前后端部署、OSS 同步 | 必填（生产部署）                 |
| `FC_SERVICE_NAME`                                   | 函数计算服务名                  | 与 `infra/s*.yaml` 环境变量对应  |
| `DATABASE_URL`                                      | 生产数据库连接串                | 提供给 FC 运行时                 |
| `JWT_SECRET`                                        | 后端 JWT 密钥                   | FC 环境变量                      |
| `VPC_ID` / `VSWITCH_ID` / `SECURITY_GROUP_ID`       | FC VPC 配置                     | 必须与数据库所在 VPC 一致        |
| `MIGRATION_TOKEN_PROD`                              | 生产迁移保护 Token              | 供 FC 内部迁移接口校验           |
| `MIGRATION_ENDPOINT_PROD`                           | （可选）直接触发迁移的 URL      | 若不提供，使用部署后的 FC URL    |
| `OSS_BUCKET_PROD`                                   | 前端产物上传目标桶              | `frontend-pipeline` 部署阶段使用 |
| `VITE_API_BASE_URL`                                 | 前端构建时的 API 地址           | CI 构建注入                      |
| `VITE_SENTRY_DSN`                                   | 前端 Sentry DSN（可选）         | 为空则不启用 Sentry              |

## GitHub Actions Variables

| 名称            | 用途             | 备注                                       |
| --------------- | ---------------- | ------------------------------------------ |
| `ENABLE_DEPLOY` | 是否允许生产部署 | 仅当为 `'true'` 且分支为 `main` 时触发部署 |

## 本地/示例配置

- 本地与初始化脚本示例：`scripts/setup.env.example`、`apps/*/.env.example`。新增云资源或配置项时，请同步这些示例文件。 |
- `infra/s.yaml` / `infra/s.prod.yaml` 环境变量与上述 Secrets/Variables 一一对应，部署前需确保已配置。 |
